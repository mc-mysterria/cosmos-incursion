# Technical Task: The "Cosmos Incursion" System

## 1. Project Overview
**Goal:** Implement a dynamic, high-stakes PvP event ("The Cosmos Incursion") to provide end-game content for Sequence 4 (Demigod) players while ensuring participation remains viable for Low-Sequence players and non-beyonders as well.
**Core Concept:** A "Death Zone" that auto-deploys based on server population, featuring forced PvP risk (Sequence Regression on death), asymmetrical balancing, and Town-based territory control.
**Dependencies:** Lord of The Mysteries (Core Plugin), HuskTowns, BlueMap, PlaceholderAPI.

---

## 2. Event Lifecycle (Auto-Deployment)
The event acts as a temporary "Incursion" rather than a permanently active region.

### A. Trigger Logic (State Machine)
* **Activation Condition:** The event automatically starts if `Global Online Players >= 30` (should be configurable in the config)
* **Cooldown:** Enforce a strict cooldown (e.g., 2 hours, probably configurable in the config) after an event finishes to prevent fatigue.
* **Arena Selection:** The plugin should create several incursionZones in different locations, based on the locations of towns to ensure incursionZones are distanced fairly on the same distance between them.
* **Town Protection:** Zone cannot be created on chunks claimed by the city to ensure Towns remain safe havens for those who don't want to participate.

### B. Visual Integration (BlueMap)
* **API Hook:** Upon activation, hook into **BlueMap**.
* **Indicator:** Draw a distinct **ShapeMarker** (e.g., Red Circle/Square) covering the active incursionZone boundaries.
* **Label:** Set marker label to: *"Cosmos Incursion (Active)"*.
* **Cleanup:** Automatically remove the marker when the event ends or the incursionZone deactivates.

---

## 3. Zone Rules & Mechanics
These rules apply immediately to any player entering the active Incursion Zone.

### A. "Safe Mode" Override
* **Action:** Force safe mode to the "false" using API.
* **Restriction:** Block the ability to re-enable Safe Mode while inside the region boundaries.
* **Feedback:** Display a Title/Action Bar warning: *"The barrier of reality dissolves..."*

### B. Anti-Combat Logging
* **Logic:** Listen for `PlayerQuitEvent` inside the incursionZone.
* **Action:** Spawn a temporary NPC ("Hollow Body") with the player's exact health and inventory.
* **Consequence:** If the NPC is killed, the player is treated as "Dead" upon their next login, triggering all Death Zone penalties.

---

## 4. Power Balancing (Asymmetrical Warfare)
Mechanics to bridge the power gap between Sequence 4 (Demigods) and Sequence 9 (Low-tiers).

### A. "Spirit Weight" (High-Tier Penalties)
* **Target:** Sequence 4 & 5 Players.
* **Visibility:** Permanently apply the **GLOWING** status effect. They cannot hide.
* **Attrition:** Apply a slow "Sanity Drain" or "Corrosion" damage over time. This prevents camping and forces active play.

### B. The "Insignificant" (Low-Tier Buffs)
* **Target:** Sequence 9â€“6 and Non-Beyonders.
* **Stealth:** No Glowing effect. Standard stealth mechanics apply.
* **Immunity:** 0% damage taken from the incursionZone's environmental attrition.
* **Utility:** Access to "Tactical Items" (see Section 7) that are unusable by High-Tiers.

### C. Anti-Griefing (The Bounty)
* **Condition:** If a High-Tier kills > 3 Low-Tiers (who are >3 sequences below them) within 10 minutes.
* **Action:** Mark the killer as a "Corrupted Monster" on BlueMap/Global Chat to attract other High-Tiers to hunt them.
* **Loot:** Killing players >3 Sequences lower than you yields **NO** rewards (No Keys, No Loot).

---

## 5. Death & Risk System
The core "High Stakes" loop.

### A. Demigod Punishment (Seq 4)
If a Sequence 4 player dies to PvP inside the incursionZone:
1.  **Sequence Regression:** Downgrade player to **Sequence 5** (100% Acting).
2.  **Characteristic Drop:** Drop 1x **"Sequence 4 Beyonder Characteristic"** item at death location.
3.  **Loot:** Killer receives 1x **"Cosmos Crate" via command or API**.

### B. The "Paper Angel" (Insurance)
* **Item:** A high-value consumable item (`Material.PAPER`, PDC value: `paper_angel`).
* **Check:** On death, check victim inventory for this item.
* **Effect (If Found):**
    * Item is removed/consumed.
    * **Sequence Regression is CANCELLED.**
    * **Characteristic Drop is CANCELLED.**
    * **Killer Reward:** The Killer *still* receives the "Cosmos Crate Key" (generated by server).
* **Effect (If Not Found):** Standard penalties apply.

---

## 6. Objectives: Territory Control
A "King of the Hill" system where player count matters more than individual power.

### A. Capture Logic
* **Objects:** "Spirit Beacons" (defined regions / blocks within the incursionZone marked with activated Beacons).
* **Weighting:** Capture speed is based on **Player Count**.
    * 1x Sequence 9 Player = 1 Point/sec.
    * 1x Sequence 4 Player = 1 Point/sec.
    * *Result:* A swarm of low-tiers captures faster than a solo Demigod.

### B. Global Rewards
If a Town controls the Beacons when the event ends (or holds for X duration):
* **Buff:** Apply to *all* Town Members (online).
    * Effect: **+10% Acting Speed** & **Reduced Ritual Costs**.
    * Duration: 24 Hours (or until next event).

---

## 7. Custom Items & Rewards

### A. The "Cosmos Crate" (PvP Reward)
* **Source:** Crates are obtained by killing other players in the incursionZone.
* **How to grant:** Granted by a third-party command via command